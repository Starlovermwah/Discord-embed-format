<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Discord Embed Formatter</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-image: url('https://t4.ftcdn.net/jpg/02/43/75/73/360_F_243757367_gBpS6R5c8DB7pL5gw9gi9KXlzFfbdZOA.jpg');
        background-size: cover;
        background-repeat: no-repeat;
        background-attachment: fixed;
        padding: 20px;
        margin: 0;
    }
    .form-container {
        max-width: 1200px;
        background-image: url('https://img.freepik.com/premium-photo/light-blue-color-toned-square-sheet-paper_696657-29418.jpg');
        background-size: cover;
        background-repeat: no-repeat;
        border-radius: 10px;
        padding: 20px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        margin: 0 auto;
        display: grid;
        gap: 20px;
        grid-template-columns: 1fr 1fr;
    }
    .form-container h2 {
        text-align: center;
        grid-column: span 2;
    }
    .form-group {
        margin-bottom: 15px;
        text-align: center;
    }
    .form-group label {
        font-weight: bold;
        display: block;
        margin-bottom: 5px;
        text-align: center;
    }
    .form-group input[type="text"], .form-group textarea {
        width: calc(100% - 16px);
        padding: 8px;
        border: 1px solid #ccc;
        border-radius: 5px;
        font-size: 16px;
        box-sizing: border-box;
        margin-top: 8px;
    }
    .form-group input[type="submit"] {
        background-color: #4CAF50;
        color: white;
        border: none;
        padding: 10px 20px;
        text-align: center;
        text-decoration: none;
        display: inline-block;
        font-size: 16px;
        border-radius: 5px;
        cursor: pointer;
        margin-top: 20px;
    }
    .generated-url {
        background-color: #f0f0f0;
        padding: 15px;
        border-radius: 5px;
        margin-top: 15px;
        font-size: 14px;
        line-height: 1.6;
        overflow-wrap: break-word;
        grid-column: span 2;
        display: none;
        text-align: center;
    }
    .backdrop-container {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 40px;
        justify-items: center;
    }
    .banner-results {
        display: grid;
        grid-template-columns: repeat(3, minmax(200px, 1fr));
        gap: 40px;
    }
    .banner-results img {
        width: 100%;
        height: auto;
        max-width: 100%;
        object-fit: cover;
        border-radius: 10px;
        cursor: pointer;
        border: 2px solid transparent;
        transition: border-color 0.3s ease, transform 0.3s ease;
    }
    .banner-results img.selected {
        border-color: #4CAF50;
        transform: scale(1.1);
    }
    .embed-selector {
        grid-column: span 2;
        text-align: center;
    }
    .embed-selector select {
        padding: 8px;
        font-size: 16px;
        border: 1px solid #ccc;
        border-radius: 5px;
    }
    .embed-iframe {
        grid-column: span 2;
        text-align: center;
        margin-top: 20px;
    }
    .embed-iframe iframe {
        width: 100%;
        height: 700px;
        border: none;
        border-radius: 5px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
</style>
</head>
<body>
<div class="form-container">
    <h2>Discord Embed Formatter made by Starlover</h2>
    <form id="movieForm" enctype="multipart/form-data">
        <div class="form-group">
            <label for="apiKey"><a href="https://www.themoviedb.org/settings/api" target="_blank">TMDB API Key</a>:</label>
            <input type="text" id="apiKey" name="apiKey">
        </div>
        <div class="form-group">
            <label for="movieTitle">Movie Name:</label>
            <input type="text" id="movieTitle" name="movieTitle">
        </div>
        <div class="form-group">
            <label for="movieLink">Movie Link:</label>
            <input type="text" id="movieLink" name="movieLink">
        </div>
        <div class="form-group">
            <label for="backdropSearch">Backdrop Image Search:</label>
            <input type="text" id="backdropSearch" name="backdropSearch" placeholder="Enter movie title to search for backdrop images">
        </div>
        <div class="form-group">
            <label for="customBackdropLink">Custom Backdrop URL:</label>
            <input type="text" id="customBackdropLink" name="customBackdropLink" placeholder="Enter custom backdrop image URL">
        </div>
        <div class="form-group">
            <input type="submit" value="Generate Movie URL">
        </div>
    </form>
    <div class="backdrop-container">
        <div id="backdropResults" class="banner-results"></div>
    </div>
    <div id="result" class="generated-url"></div>
    <div class="embed-selector">
        <label for="embedPage">Select Fileditch Page:</label>
        <select id="embedPage">
            <option value="fileditch">Permanent FileDitch</option>
            <option value="fileditch72">Temporary FileDitch</option>
        </select>
    </div>
    <div class="embed-iframe">
        <h2>Fileditch Page</h2>
        <iframe id="embedFrame" title="Embedded Page"></iframe>
    </div>
</div>

<script>
    var embedFrame = document.getElementById('embedFrame');
    embedFrame.src = 'https://fileditch.com';

    document.getElementById('movieForm').addEventListener('submit', function(event) {
        event.preventDefault();

        var apiKey = document.getElementById('apiKey').value.trim();
        var movieTitle = document.getElementById('movieTitle').value.trim();
        var movieLink = document.getElementById('movieLink').value.trim();
        var selectedBackdrop = document.querySelector('.banner-results img.selected');
        var customBackdropLink = document.getElementById('customBackdropLink').value.trim();

        var encodedMovieLink = movieLink ? encodeURIComponent(movieLink).replace(/%3A/g, ':').replace(/%2F/g, '/') : '';

        var backdropResultsContainer = document.getElementById('backdropResults');

        if (movieTitle) {
            if (customBackdropLink && customBackdropLink !== '') {
                var generatedURL = `[${movieTitle}](https://discord.nfp.is/?v=${encodedMovieLink}&i=${customBackdropLink})`;
                displayGeneratedURL(generatedURL);
            } else if (apiKey && selectedBackdrop) {
                var selectedImagePath = selectedBackdrop.getAttribute('data-image-path');
                var tmdbImageUrl = 'https://image.tmdb.org/t/p/w1280/';
                var generatedURL = `[${movieTitle}](https://discord.nfp.is/?v=${encodedMovieLink}&i=${tmdbImageUrl}${selectedImagePath})`;
                displayGeneratedURL(generatedURL);
            } else {
                var generatedURL = `[${movieTitle}](https://discord.nfp.is/?v=${encodedMovieLink})`;
                displayGeneratedURL(generatedURL);
            }
        } else {
            console.error('Movie title is required');
        }
    });

    function displayGeneratedURL(url) {
        var resultContainer = document.getElementById('result');
        resultContainer.textContent = url;
        resultContainer.style.display = url ? 'block' : 'none';
    }

    document.getElementById('embedPage').addEventListener('change', function() {
        var selectedValue = this.value;
        if (selectedValue === 'fileditch') {
            embedFrame.src = 'https://fileditch.com';
        } else if (selectedValue === 'fileditch72') {
            embedFrame.src = 'https://fileditch.com/temp.html';
        }
    });

    function fetchMovieData(query, apiKey) {
        var apiUrl = 'https://api.themoviedb.org/3/search/movie';
        var url = `${apiUrl}?api_key=${apiKey}&query=${encodeURIComponent(query)}`;
        return fetch(url).then(response => response.json());
    }

    function fetchMovieBackdrops(movieId, apiKey) {
        var apiUrl = `https://api.themoviedb.org/3/movie/${movieId}/images`;
        var url = `${apiUrl}?api_key=${apiKey}`;
        return fetch(url)
            .then(response => response.json())
            .then(data => {
                if (data.backdrops) {
                    return data.backdrops.slice(0, 9);
                } else {
                    throw new Error('Backdrops not found');
                }
            });
    }

    document.getElementById('backdropSearch').addEventListener('input', function() {
        var query = this.value;
        var apiKey = document.getElementById('apiKey').value.trim();
        var backdropResultsContainer = document.getElementById('backdropResults');
        backdropResultsContainer.innerHTML = '';

        if (query.trim() !== '') {
            fetchMovieData(query, apiKey)
                .then(data => {
                    if (data.results.length > 0) {
                        var movieId = data.results[0].id;
                        return fetchMovieBackdrops(movieId, apiKey);
                    } else {
                        throw new Error('Movie not found');
                    }
                })
                .then(backdrops => {
                    backdrops.forEach(backdrop => {
                        var img = document.createElement('img');
                        img.src = `https://image.tmdb.org/t/p/w1280${backdrop.file_path}`;
                        img.alt = backdrop.file_path;
                        img.setAttribute('data-image-path', backdrop.file_path);
                        img.onclick = function() {
                            document.querySelectorAll('.banner-results img').forEach(img => img.classList.remove('selected'));
                            this.classList.add('selected');
                        };
                        backdropResultsContainer.appendChild(img);
                    });
                })
                .catch(error => {
                    console.error('Error fetching movie data:', error);
                });
        }
    });
</script>
</body>
</html>
